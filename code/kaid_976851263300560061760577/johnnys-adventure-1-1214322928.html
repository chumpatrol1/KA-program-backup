<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Johnny's Adventure 1</title>
    <link rel="stylesheet" href="../../build/css/live-editor.core_deps.css"/>
    <link rel="stylesheet" href="../../build/css/live-editor.audio.css"/>
    <link rel="stylesheet" href="../../build/css/live-editor.tooltips.css"/>
    <link rel="stylesheet" href="../../build/css/live-editor.ui.css"/>
<style>
        body {
            padding: 20px;
        }
        h1 {
            padding: 0;
            margin: 0 0 20px 0;
        }
        #sample-live-editor {
            padding: 0;
        }
    </style>
</head>
<body>
    <h1>Johnny's Adventure 1</h1>
    <div id="sample-live-editor"></div>
    <script src="../../build/js/live-editor.core_deps.js"></script>
    <script src="../../build/js/live-editor.editor_ace_deps.js"></script>
    <script src="../../build/js/live-editor.audio.js"></script>
    <script src="../../build/js/live-editor.shared.js"></script>
    <script src="../../build/js/live-editor.tooltips.js"></script>
    <script src="../../build/js/live-editor.ui.js"></script>
    <script src="../../build/js/live-editor.editor_ace.js"></script>
    <script>
    var outputUrl = "../output.html";
var code = "/**Johnny's Adventure 1 by David Elijah de Siqueira Campos McLaughlin\nOriginal size(400, 400);\nOriginally Created on 2012-12-10T19:34:56Z by kaid_976851263300560061760577\nLast Edited: 2012-12-10T19:34:56Z\nVotes/Spinoffs: 1/0\nOriginally Created: 2012-12-12T19:43:38Z from origin 1024441648 with similarity of 0.9788468288717693\nOriginal Link: https://www.khanacademy.org/computer-programming/johnnys-adventure-1/1214322928\nRetrieved On: 07-Nov-2022 (17:07:26.900273)**/\
";

code = code + "\n// Oh no! your toy robots are on a rampage and you must stop them! The controls are left arrow, right arrow, down arrow shift, up arrow or space bar. you have to kill all of the enemies and hit the star at the end to win.\n\n// Push the H key for help!\n\n// Please give me credit when you make a spin-off thanks!\n\n\n// Good luck and have fun!\n\n\n// Send me ideas and bugs here http://www.khanacademy.org/cs/robo-jump-questions-and-suggestions/1066610804\n\n\n// You can email me here chumpatrol1@gmail.com\n\nvar lives = 3;\n\nvar score = 0;\n\nvar robots = 11;\n\nvar powerup = 1;\n\nvar gamestart = false;\n\nvar victory = 1;\n\nvar paused = false;\n\nvar credits = false;\n\nvar robotmove = 0;\n\nvar boy = getImage(\"avatars/robot_male_1\");\n\nvar robot = getImage(\"cute/CharacterBoy\");\n\nvar drawcredits = function(){\n            \n    background(61, 59, 61);\n    \n    textSize(20);\n    \n    text(\"Robo Jump\", 150, 26);\n    \n    text(\"Created by:\", 150, 66);\n    \n    text(\"Timothy\", 165, 106);\n    \n    text(\"Fans:\", 176, 146);\n    \n    text(\"1. :~)\", 176, 186);\n            \n};\n\nvar GameIntro = function() {\n\n    background(61, 59, 61);\n\n    strokeWeight(3);\n\n    stroke(255, 0, 0);\n\n    fill(250, 188, 0);\n\n    rect(0, 0, 400, 115);\n\n    fill(0, 0, 0);\n\n    textSize(17);\n\n    image(boy, 32, 218);\n\n    image(robot, 256, 194);\n\n    text(\"Johnny is going on another of his adventures to get\\nrich. Again. However, guards have spotted him and\\nare patrolling the kingdom trying to catch him. Use the\\n left and right arrow keys to move, up or space to\\njump, shift with left or right to run and down for gems.\\n\", 5, 24);\n\n    strokeWeight(5);\n\n    stroke(255, 0, 0);\n\n    fill(250, 188, 0);\n\n    rect(150, 181, 100, 50);\n\n    fill(0, 0, 0);\n\n    text(\"Start\", 182, 212);\n    \n    if(mouseIsPressed && mouseX > 150 && mouseX < 300 && mouseY > 181 && mouseY < 235){\n        \n    gamestart = true;\n    \n    }\n    \n    stroke(255, 0, 0);\n\n    fill(250, 188, 0);\n\n    rect(1, 347, 100, 50);\n\n    fill(0, 0, 0);\n\n    text(\"Credits\", 25, 378);\n\n    if(mouseIsPressed && mouseX > 1 && mouseX < 600 && mouseY > 347 && mouseY < 600){\n        \n        credits = true;\n        \n    }\n    \n    if (credits === true){\n        \n        drawcredits();\n        \n    }\n\n};\n\n\n\nvar drawBackground = function() {\n\n    background(61, 59, 61);\n\n    textSize(17);\n\n    fill(255, 0, 0);\n\n};\n\n\nvar TILE_HEIGHT = 43;\n\nvar TILE_WIDTH = 100;\n\nvar HERO_HEIGHT = 68;\n\nvar HERO_WIDTH = 80;\n\nvar ROBOT_HEIGHT = 80;\n\nvar ROBOT_WIDTH = 100;\n\n\nvar TILE_MAP = [\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 0, 0, 2, 0, 2, 0, 0, 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 2, 3, 2, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 5, 0],\n\n[0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 2, 4, 2, 2, 0, 0, 0, 0, 0, 2, 4, 2, 0, 0, 0, 0, 2, 4, 2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0],\n\n[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n\n];\n\n\nvar TILE_MAP_ROWS = TILE_MAP.length;\n\nvar TILE_MAP_COLS = TILE_MAP[0].length;\n\n\n// enemies\n\nvar ENEMY_MAP = [\n\n[0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\n[0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0]\n\n];\n\n\nvar SCREEN_ROWS = 7;\n\nvar SCREEN_COLS = 4;\n\nvar isGameOver = false;\n\nvar GRAVITY = 2;\n\n// tile access\n\n// -----------\n\nvar tileFor = function(tX, tY) {\n\n    if (typeof tX === \"object\") {\n\n        // someone passed in tileFor([tX, tY])\n\n        tY = tX[1];\n\n        tX = tX[0];\n\n    }\n\n    if (tY < TILE_MAP_ROWS && tX < TILE_MAP_COLS && tY >= 0 && tX >= 0) {\n\n        return TILE_MAP[tY][tX];\n\n    } else if (tY < 0) {\n\n        // this tile is above the screen, so it\'s open space\n\n        return 0;\n\n    } else {\n\n        // this tile is impassable\n\n        return -1;\n\n    }\n\n};\n\n// turns some point (x, y) into the (tX, tY) covering that point\n\nvar tileCoordsForPoint = function(x, y) {\n\n    if (typeof x === \"object\") {\n\n        // passed [x, y]\n\n        y = x[1];\n\n        x = x[0];\n\n    }\n\n    return [floor(x / TILE_WIDTH), floor(y / TILE_HEIGHT)];\n\n};\n\n\nvar tileForPoint = function(x, y) {\n\n    var tileCoords = tileCoordsForPoint(x, y),\n\n    tX = tileCoords[0],\n\n    tY = tileCoords[1];\n\n    return tileFor(tX, tY);\n\n};\n\n\nvar rectIntersectsRect = function(x1, y1, w1, h1, x2, y2, w2, h2) {\n\n    return ( ((x1 <= x2) && (x2 <= x1 + w1)) ||\n\n             ((x2 <= x1) && (x1 <= x2 + w2)) ) &&\n\n           ( ((y1 <= y2) && (y2 <= y1 + h1)) ||\n\n             ((y2 <= y1) && (y1 <= y2 + h2)) );\n\n};\n\n\nvar rectIntersectsTile = function(x, y, w, h, tX, tY) {\n\n    return rectIntersectsRect(x, y, w, h,\n\n        tX * TILE_WIDTH,\n\n        tY * TILE_HEIGHT,\n\n        tX * TILE_WIDTH + TILE_WIDTH,\n\n        tY * TILE_HEIGHT + TILE_HEIGHT);\n\n};\n\n\nvar dudeIntersectsTile = function(dude, tX, tY) {\n\n    return rectIntersectsTile(\n\n        dude.x + dude.cXOffset,\n\n        dude.y + dude.cYOffset,\n\n        dude.cWidth,\n\n        dude.cHeight,\n\n        tX, tY);\n\n};\n\n\nvar dudeIntersectsDude = function(dude1, dude2) {\n\n    return rectIntersectsRect(\n\n        dude1.x + dude1.cXOffset,\n\n        dude1.y + dude1.cYOffset,\n\n        dude1.cWidth,\n\n        dude1.cHeight,\n\n        dude2.x + dude2.cXOffset,\n\n        dude2.y + dude2.cYOffset,\n\n        dude2.cWidth,\n\n        dude2.cHeight);\n\n};\n\n\nvar t = 0;\n\nvar scrollX = 0, scrollY = 0;\n\nvar animMap = {};\n\nvar tileImages = {\n\n    1: getImage(\"cute/BrownBlock\"),\n\n    2: getImage(\"cute/WallBlock\"),\n\n    3: getImage(\"cute/ChestClosed\"),\n\n    4: getImage(\"cute/TreeTall\"),    \n\n    5: getImage(\"space/collisioncircle\")\n    \n};\n\n\nvar animFor = function(tX, tY) {\n\n    if (tY in animMap && tX in animMap[tY]) {\n\n        var anim = animMap[tY][tX];\n\n        if (anim.type === \"powerup\") {\n\n            anim.yOffset = anim.t*anim.t - 6*anim.t;\n\n            if (anim.t > 0 && anim.yOffset === 0) {\n\n                delete animMap[tY][tX];\n\n            }\n\n        }\n\n        anim.t += 1;\n\n        return anim;\n\n    }\n\n};\n\n\nvar drawTile = function(tX, tY) {\n\n\n\n    var anim = animFor(tX, tY);\n\n\n\n    if (anim) {\n\n\n\n        image(tileImages[anim.tile], TILE_WIDTH * tX + scrollX + anim.xOffset, TILE_HEIGHT * tY + scrollY + anim.yOffset);\n\n\n\n\n\n\n\n    } else {\n\n\n\n        var tileImage = tileImages[tileFor(tX, tY)];\n\n\n\n\n\n\n\n        if (!tileImage) {\n\n\n\n            return;\n\n\n\n        }\n\n\n\n\n\n\n\n        image(tileImages[tileFor(tX, tY)], TILE_WIDTH * tX + scrollX, TILE_HEIGHT * tY + scrollY);\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nvar dudeImages = {\n\n\n\n    1: getImage(\"avatars/robot_male_1\"),\n\n\n\n    2: getImage(\"cute/CharacterBoy\"),\n\n\n\n    3: getImage(\"cute/CharacterPinkGirl\")\n\n\n\n};\n\n\n\n\n\n\n\nvar powerImages = {\n\n\n\n    \"armed\": getImage(\"cute/GemBlue\")\n\n\n\n};\n\n\n\n\n\n\n\nvar hero = {\n\n\n\n    // these are properties that all kinds of characters have\n\n\n\n    // including the hero\n\n\n\n    x: 0,\n\n\n\n    y: 0,\n\n\n\n\n\n\n\n    xVelocity: 0,\n\n\n\n    yVelocity: 0,\n\n\n\n\n\n\n\n    wounded: false,\n\n\n\n    lastWounded: 0,\n\n\n\n\n\n\n\n    cXOffset: 20,\n\n\n\n    cWidth: HERO_WIDTH - 40,\n\n\n\n    cYOffset: 0,\n\n\n\n    cHeight: HERO_HEIGHT,\n\n\n\n\n\n\n\n    im: 1,\n\n\n\n\n\n\n\n    // only the hero has the following properties, though\n\n\n\n    jump: 0, // increases as you hold down JUMP, so a brief tap !== a long press\n\n\n\n    running: false,\n\n\n\n\n\n\n\n    facesLeft: false,\n\n\n\n    ySway: 0,\n\n\n\n    \n\n\n\n    power: \"none\",\n\n\n\n    dead: false\n\n\n\n};\n\n\n\n\n\n\n\nvar hitPowerup = function(tX, tY) {\n\n\n\n    if (!(tY in animMap)) {\n\n\n\n        animMap[tY] = {};\n\n\n\n    }\n\n\n\n\n\n\n\n    animMap[tY][tX] = {\n\n\n\n        tile: tileFor(tX, tY),\n\n\n\n        type: \"powerup\",\n\n\n\n\n\n\n\n        xOffset: 0,\n\n\n\n        yOffset: 0,\n\n\n\n        \n\n\n\n        t: 0\n\n\n\n    };\n\n\n\n    \n\n\n\n    if (hero.power === \"none\") {\n\n\n\n        hero.power = \"armed\";\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nvar drawDude = function(dude) {\n\n\n\n    var mod;\n\n\n\n    \n\n\n\n    if (dude.wounded && round(t / 3) % 2 === 0) {\n\n\n\n        return;\n\n\n\n    }\n\n\n\n    \n\n\n\n    if (dude.xVelocity !== 0) {\n\n\n\n        if (dude.xVelocity < 0) {\n\n\n\n            dude.facesLeft = true;\n\n\n\n        } else if (dude.xVelocity > 0) {\n\n\n\n            dude.facesLeft = false;\n\n\n\n        }\n\n\n\n        \n\n\n\n        if (dude.yVelocity === 0) {\n\n\n\n            if (dude.ySway === 0) {\n\n\n\n                dude.ySway = 1;\n\n\n\n            } else {\n\n\n\n                if (dude.running) {\n\n\n\n                    mod = 3;\n\n\n\n                } else {\n\n\n\n                    mod = 4;\n\n\n\n                }\n\n\n\n                \n\n\n\n                if ((t % mod) === 0) {\n\n\n\n                    dude.ySway = -dude.ySway;\n\n\n\n                }\n\n\n\n            }\n\n\n\n        }\n\n\n\n    } else {\n\n\n\n        dude.ySway = 0;\n\n\n\n    }\n\n\n\n    \n\n\n\n    var img = dudeImages[dude.im];\n\n\n\n\n\n\n\n    var dying = dude.dead && (dude.y + scrollY) < height;\n\n\n\n    \n\n\n\n    if (dying) {\n\n\n\n        pushMatrix();\n\n\n\n        dude.rotation += 1;\n\n\n\n        \n\n\n\n        rotate(dude.rotation);\n\n\n\n    }\n\n\n\n    \n\n\n\n    if (dude.facesLeft) {\n\n\n\n        pushMatrix();\n\n\n\n        scale(-1, 1);\n\n\n\n        image(img, -(dude.x + scrollX + img.width), dude.y + scrollY + dude.ySway);\n\n\n\n        popMatrix();\n\n\n\n    } else {\n\n\n\n        image(img, dude.x + scrollX, dude.y + scrollY + dude.ySway);\n\n\n\n    }\n\n\n\n\n\n\n\n    if (dude.power && dude.power !== \"none\") {\n\n\n\n        image(powerImages[dude.power], dude.x + scrollX, dude.y + scrollY + dude.ySway);\n\n\n\n    }\n\n\n\n    \n\n\n\n    if (dying) {\n\n\n\n        popMatrix();\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\n// sectumsempra\n\n\n\n// ------------\n\n\n\nvar enemies = [];\n\n\n\n\n\n\n\nvar loadEnemy = function(id, tX, tY) {\n\n\n\n    var im;\n\n\n\n    \n\n\n\n    if (id === 0) {\n\n\n\n        return;\n\n\n\n    }\n\n\n\n    \n\n\n\n    enemies.push({\n\n\n\n        x: tX * ROBOT_WIDTH,\n\n\n\n        y: tY * ROBOT_HEIGHT,\n\n\n\n        \n\n\n\n        xVelocity: 0,\n\n\n\n        yVelocity: 0,\n\n\n\n        \n\n\n\n        wounded: false,\n\n\n\n        \n\n\n\n        im: id,\n\n\n\n        \n\n\n\n        ySway: 0,\n\n\n\n        \n\n\n\n        cXOffset: 0,\n\n\n\n        cWidth: TILE_WIDTH,\n\n\n\n        cYOffset: 0,\n\n\n\n        cHeight: TILE_HEIGHT\n\n\n\n    });\n\n\n\n};\n\n\n\n\n\n\n\nvar loadEnemies = function() {\n\n\n\n    for (var tY = 0; tY < TILE_MAP_ROWS; tY += 1) {\n\n\n\n        for (var tX = 0; tX < TILE_MAP_COLS; tX += 1) {\n\n\n\n            if (ENEMY_MAP[tY][tX] !== 0) {\n\n\n\n                loadEnemy(ENEMY_MAP[tY][tX], tX, tY);\n\n\n\n            }\n\n\n\n        }\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nloadEnemies();\n\n\n\n\n\n\n\nvar drawEnemies = function() {\n\n\n\n    for (var i = 0; i < enemies.length; i += 1) {\n\n\n\n        drawDude(enemies[i]);\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\n\n\n\n\n// drawing\n\n\n\n// -------\n\n\n\nvar drawMapBelowHero = function() {\n\n\n\n    var heroRow = max(floor(hero.y / TILE_HEIGHT), 0);\n\n\n\n    // have to draw rows at the bottom first, and go upward\n\n\n\n    for (var tY = TILE_MAP_ROWS - 1; tY >= heroRow; tY -= 1) {\n\n\n\n        for (var tX = 0; tX < TILE_MAP_COLS; tX += 1) {\n\n\n\n            drawTile(tX, tY);\n\n\n\n        }\n\n\n\n    }\n\n\n\n};\n\n\n\nvar drawMapAboveHero = function() {\n\n\n\n    // have to draw rows at the bottom first, and go upward\n\n\n\n    var heroRow = floor(hero.y / TILE_HEIGHT);\n\n\n\n    \n\n\n\n    if (heroRow >= 0) {\n\n\n\n        for (var tY = heroRow; tY >= 0; tY -= 1) {\n\n\n\n            for (var tX = 0; tX < TILE_MAP_COLS; tX += 1) {\n\n\n\n                drawTile(tX, tY);\n\n\n\n            }\n\n\n\n        }\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\n// collisions\n\n\n\n// ----------\n\n\n\n\n\n\n\n// tiles adjacent to dudes\n\n\n\nvar tileCoordsAdj = function(dude, dir, amt) {\n\n\n\n    var x, y;\n\n\n\n    amt = amt || 1;\n\n\n\n\n\n\n\n    if (dir === \"left\") {\n\n\n\n        x = dude.x + dude.cXOffset - amt;\n\n\n\n        y = dude.y + dude.cYOffset;\n\n\n\n    } else if (dir === \"right\") {\n\n\n\n        x = dude.x + dude.cXOffset + dude.cWidth + amt;\n\n\n\n        y = dude.y + dude.cYOffset;\n\n\n\n    } else if (dir === \"below left\") {\n\n\n\n        x = dude.x + dude.cXOffset;\n\n\n\n        y = dude.y + dude.cYOffset + dude.cHeight + amt;\n\n\n\n    } else if (dir === \"below right\") {\n\n\n\n        x = dude.x + dude.cXOffset + dude.cWidth;\n\n\n\n        y = dude.y + dude.cYOffset + dude.cHeight + amt;\n\n\n\n    } else if (dir === \"above left\") {\n\n\n\n        x = dude.x + dude.cXOffset;\n\n\n\n        y = dude.y + dude.cYOffset - amt;\n\n\n\n    } else if (dir === \"above right\") {\n\n\n\n        x = dude.x + dude.cXOffset + dude.cWidth;\n\n\n\n        y = dude.y + dude.cYOffset - amt;\n\n\n\n    }\n\n\n\n    \n\n\n\n    return tileCoordsForPoint(x, y);\n\n\n\n};\n\n\n\n\n\n\n\nvar tileAdj = function(dude, dir, amt) {\n\n\n\n    return tileFor(tileCoordsAdj(dude, dir, amt));\n\n\n\n};\n\n\n\n\n\n\n\n// tile checks\n\n\n\nvar tileIsBlocking = function(tile) {\n\n\n\n    return tile !== 0;\n\n\n\n};\n\n\n\nvar tileIsVictory = function(tile) {\n\n    \n\n    return tile === 5;\n\n    \n\n};\n\n\n\nvar tileIsPowerup = function(tile) {\n\n\n\n    return tile === 3;\n\n\n\n};\n\n\n\n\n\n\n\nvar tileAdjIsBlocking = function(dude, dir, amt) {\n\n\n\n    if (dir === \"left\" || dir === \"right\") {\n\n\n\n        return tileIsBlocking(tileAdj(dude, dir, amt));\n\n\n\n\n\n\n\n    } else if (dir === \"below\" || dir === \"above\") {\n\n\n\n        return tileIsBlocking(tileAdj(dude, dir + \" left\", amt)) ||\n\n\n\n            tileIsBlocking(tileAdj(dude, dir + \" right\", amt));\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nvar checkXCollisions = function(dude) {\n\n    \n\n    var tal, tar;\n\n\n\n    // FIXME jump into block above you bug\n\n\n\n    if (tileAdjIsBlocking(dude, \"left\") && dude.xVelocity < 0) {\n\n        dude.xVelocity = 0;\n\n\n\n        while (tileAdjIsBlocking(dude, \"left\") && !tileAdjIsBlocking(dude, \"right\")) {\n\n\n\n            dude.x += 1;\n\n\n\n        }\n\n\n\n    } else if (tileAdjIsBlocking(dude, \"right\") && dude.xVelocity > 0) {\n\n\n\n        dude.xVelocity = 0;\n\n\n\n        while (tileAdjIsBlocking(dude, \"right\") && !tileAdjIsBlocking(dude, \"left\")) {\n\n\n\n            dude.x -= 1;\n\n\n\n        }\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nvar checkYCollisions = function(dude) {\n\n\n\n    var tal, tar;\n\n\n\n    var curTile = tileCoordsForPoint(dude.x, dude.y);\n\n\n\n    if (tileAdjIsBlocking(dude, \"below\") && dude.yVelocity > 0) {\n\n\n\n        dude.yVelocity = 0;\n\n\n\n        while (tileAdjIsBlocking(dude, \"below\")) {\n\n\n\n            dude.y -= 1;\n\n\n\n        }\n\n        \n\n    } else if (tileAdjIsBlocking(dude, \"above\") && dude.yVelocity < 0) {\n\n\n\n        dude.yVelocity = dude.yVelocity * -1/4;\n\n\n\n        tal = tileCoordsAdj(dude, \"above left\");\n\n\n\n        if (tileIsPowerup(tileFor(tal))) {\n\n            \n\n            if (powerup === 1) {\n\n                \n\n            hitPowerup(tal[0], tal[1]);\n\n            \n\n            powerup = powerup - 1;\n\n            \n\n            }\n\n\n\n        }\n\n        \n\n        if (tileIsVictory(tileFor(tal))) {\n\n            \n\n            if (victory === 1) {\n\n                \n\n                if(robots === 0) {\n\n                    \n\n                    victory = victory - 1;\n\n                    \n\n                }\n\n            \n\n            }\n\n\n\n        }\n\n        \n\n        else {\n\n\n\n            tar = tileCoordsAdj(dude, \"above right\");\n\n\n\n            if (tileIsPowerup(tileFor(tal))) {\n\n\n\n                if (powerup === 1) {\n\n                \n\n                hitPowerup(tal[0], tal[1]);\n\n            \n\n                powerup = powerup - 1;\n\n                \n\n                }\n\n\n\n            }\n\n\n\n        }\n\n        \n\n        if (tileIsVictory(tileFor(tal))) {\n\n            \n\n            if (victory === 1) {\n\n                \n\n                if (robots === 0) {\n\n                    \n\n                    victory = victory - 1;\n\n                    \n\n                }\n\n            \n\n            }\n\n\n\n        }\n\n\n\n        while (tileAdjIsBlocking(dude, \"above\")) {\n\n\n\n            dude.y += 1;\n\n            \n\n            if (tileIsPowerup(tileFor(tal))) {\n\n\n\n                if (powerup === 1) {\n\n                \n\n                hitPowerup(tal[0], tal[1]);\n\n            \n\n                powerup = powerup - 1;\n\n                \n\n                }\n\n\n\n            }\n\n            \n\n            if (tileIsVictory(tileFor(tal))) {\n\n            \n\n            if (victory === 1) {\n\n                \n\n                if (robots === 0) {\n\n                    \n\n                    victory = victory - 1;\n\n                    \n\n                }\n\n            \n\n            }\n\n\n\n        }\n\n\n\n        }\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\n// input\n\n\n\n// -----\n\n\n\nvar keyJump = false, keyLeft = false, keyRight = false;\n\n\n\nvar keyPressed = function() {\n\n\n\n    if (keyCode === UP) {\n\n\n\n        keyJump = true;\n\n\n\n    } else if (keyCode === 32) {\n\n\n\n        keyJump = true;\n\n\n\n    } else if (keyCode === SHIFT) {\n\n\n\n        hero.running = true;\n\n\n\n    } else if (keyCode === LEFT) {\n\n\n\n        keyLeft = true;\n\n\n\n    } else if (keyCode === RIGHT) {\n\n\n\n        keyRight = true;\n\n        \n\n    } else if (keyCode === DOWN) {\n\n\n\n        if (powerup === 0) {\n\n            hero.power = \"none\";\n\n            score = score + 1000;\n\n            powerup = powerup - 1;\n\n        }\n\n\n\n    } else if (keyCode === 72) {\n\n\n\n        println(\"The controls are left arrow, right arrow, down arrow shift, up arrow or space bar. you have to kill all of the enemies and hit the portal at the end to win.\");\n\n        \n\n    }\n\n\n\n};\n\n\n\nvar keyReleased = function() {\n\n\n\n    if (keyCode === UP) {\n\n\n\n        keyJump = false;\n\n\n\n    } else if (keyCode === 32) {\n\n\n\n        keyJump = false;\n\n\n\n    } else if (keyCode === SHIFT) {\n\n\n\n        hero.running = false;\n\n\n\n    } else if (keyCode === LEFT) {\n\n\n\n        keyLeft = false;\n\n\n\n    } else if (keyCode === RIGHT) {\n\n\n\n        keyRight = false;\n\n\n\n    }\n\n\n\n};\n\n\n\n// hero update stuff\n\n\n\n// -----------------\n\n\n\nvar maxHeroSpeed = function() {\n\n\n\n    if (hero.running) {\n\n\n\n        return 20;\n\n\n\n    } else {\n\n\n\n        return 9;\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nvar updateHeroXVelocity = function() {\n\n\n\n    if (keyRight) {\n\n\n\n        if (hero.xVelocity < 0) {\n\n\n\n            hero.xVelocity = 0;\n\n\n\n        }\n\n\n\n        hero.xVelocity += 1;\n\n\n\n    } else if (keyLeft) {\n\n\n\n        if (hero.xVelocity > 0) {\n\n\n\n            hero.xVelocity = 0;\n\n\n\n        }\n\n\n\n        hero.xVelocity -= 1;\n\n\n\n    } else {\n\n\n\n        if (hero.xVelocity > 0) {\n\n\n\n            hero.xVelocity -= 0.5;\n\n\n\n        } else if (hero.xVelocity < 0) {\n\n\n\n            hero.xVelocity += 0.5;\n\n\n\n        }\n\n\n\n    }\n\n\n\n\n\n\n\n    if (hero.xVelocity > maxHeroSpeed()) {\n\n\n\n        hero.xVelocity = 9;\n\n\n\n    } else if (hero.xVelocity < -maxHeroSpeed()) {\n\n\n\n        hero.xVelocity = -9;\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nvar updateHeroYVelocity = function() {\n\n\n\n    if (keyJump) {\n\n\n\n        if (hero.yVelocity === 0 && tileAdjIsBlocking(hero, \"below\", 2)) {\n\n\n\n            hero.jump = 1;\n\n\n\n        }\n\n\n\n            \n\n\n\n        if (hero.jump > 0 && hero.jump < 10) {\n\n\n\n            hero.jump += 1;\n\n\n\n            hero.yVelocity -= 6;\n\n\n\n        }\n\n\n\n    }\n\n\n\n\n\n\n\n    if (!keyJump || hero.jump >= 10) {\n\n\n\n        hero.jump = 0;\n\n\n\n    }\n\n\n\n    \n\n\n\n    if (hero.yVelocity < -18) { // max jump speed\n\n\n\n        hero.yVelocity = -18;\n\n\n\n    } else if (hero.yVelocity > 30) { // terminal velocity\n\n\n\n        // (this is as fast as you can ever fall)\n\n\n\n        hero.yVelocity = 30;\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nvar killHero = function() {\n\n\n\n    hero.yVelocity -= 100;\n\n\n\n    hero.dead = true;\n\n\n\n};\n\n\n\n\n\n\n\nvar woundHero = function() {\n\n\n\n    hero.wounded = true;\n\n\n\n    hero.lastWounded = t;\n\n\n\n    \n\n\n\n    if (hero.power !== \"none\") {\n\n\n\n        hero.power = \"none\";\n\n\n\n    } else {\n\n\n\n        killHero();\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\nvar checkEnemyCollisions = function() {\n\n\n\n    // this is intentionally under hero stuff,\n\n\n\n    // because it\'s centered around the hero\n\n\n\n    // (I guess it\'s arguable)\n\n\n\n    if (hero.wounded) {\n\n\n\n        return;\n\n\n\n    }\n\n\n\n    \n\n\n\n    for (var i = 0; i < enemies.length; i += 1) {\n\n\n\n        if (dudeIntersectsDude(hero, enemies[i])) {\n\n\n\n            if (hero.yVelocity > 0) {\n\n\n\n                // enemy\'s being jumped on\n\n                \n\n                score = score + 1000;\n\n\n\n                hero.yVelocity -= 100;\n\n\n\n                enemies.splice(i, 1);\n\n                \n\n                robots = robots - 1;\n\n\n\n            } else {\n\n\n\n                // enemy hit us!\n\n                \n\n                robots = robots - 1;\n\n\n\n                enemies.splice(i, 1);\n\n\n\n                lives = lives -1;\n\n\n\n                woundHero();\n\n\n\n            }\n\n\n\n        }\n\n\n\n    }    \n\n\n\n};\n\n\n\n\n\n\n\nvar updateHero = function() {\n\n\n\n    updateHeroXVelocity();\n\n\n    updateHeroYVelocity();\n\n\n    hero.yVelocity += GRAVITY;\n\n\n    hero.x += hero.xVelocity;\n\n\n    hero.y += hero.yVelocity;\n    \n\n    checkXCollisions(hero);\n\n\n\n    checkYCollisions(hero);\n\n\n    checkEnemyCollisions();\n\n};\n\n\nvar scroll = function() {\n\n\n\n    if ((hero.x + scrollX > width / 3 && hero.xVelocity > 0) ||\n\n\n\n        (hero.x + scrollX < width / 3 && hero.xVelocity < 0)) {\n\n\n\n        scrollX -= floor(hero.xVelocity);\n\n\n\n    }\n\n\n\n\n\n\n\n    if ((hero.y + scrollY > height / 3 && hero.yVelocity > 0) ||\n\n\n\n        (hero.y + scrollY < height / 3 && hero.yVelocity < 0)) {\n\n\n\n        scrollY -= floor(hero.yVelocity);\n\n\n\n    }\n\n\n\n};\n\n\n\n\n\n\n\n// enemy update\n\n\n\n// ------------\n\n\n\nvar updateEnemies = function() {\n\n    var enemy;\n\n    for (var i = 0; i < enemies.length; i += 1) {\n\n        enemy = enemies[i];\n\n\n\n        enemy.yVelocity += GRAVITY;\n\n        if (robotmove < 30) {\n            \n            if (gamestart)\n            {enemy.x += 3;}\n            \n        }\n        \n        if (robotmove > 30) {\n            \n            if (gamestart)\n            {enemy.x += -3;}\n            \n        }\n\n        checkXCollisions(enemy);\n\n        checkYCollisions(enemy);\n\n    }\n    \n    robotmove = robotmove + 1;\n    \n    if (robotmove === 60) {\n        \n        robotmove = 0;\n        \n    }\n\n};\n\n\n\n\n\n\n\n// game-wide updates\n\n\n\n// -----------------\n\n\n\nvar update = function() {\n\n    updateHero();\n\n    updateEnemies();\n\n    scroll();\n\n};\n\n\n\nvar drawDebugInfo = function(scaleFactor) {\n\n    // TODO make this function clean\n\n    // (it was never intended to be permanent)\n\n    \n\n    // draw a minimap of everything at 1/10 scale\n\n    // draw the whole tilemap\n\n    noStroke();\n\n    fill(255, 255, 255);\n\n    rect(0, 0, TILE_MAP_COLS*TILE_WIDTH*scaleFactor, TILE_MAP_ROWS*TILE_HEIGHT*scaleFactor);\n\n    \n\n    for (var tY = 0; tY < TILE_MAP_ROWS; tY += 1) {\n\n        for (var tX = 0; tX < TILE_MAP_COLS; tX += 1) {\n\n            if (tileFor(tX, tY) !== 0) {\n\n                fill(0, 0, 0);\n\n                rect(tX*TILE_WIDTH*scaleFactor, tY*TILE_HEIGHT*scaleFactor, TILE_WIDTH*scaleFactor, TILE_HEIGHT*scaleFactor);\n\n            }\n\n        }\n\n    }\n\n    \n\n    fill(0, 0, 255);\n\n    rect(hero.x*scaleFactor, hero.y*scaleFactor, TILE_WIDTH*scaleFactor, TILE_HEIGHT*scaleFactor);\n\n    \n\n    fill(255, 0, 0);\n\n    for (var i = 0; i < enemies.length; i += 1) {\n\n        rect(enemies[i].x*scaleFactor, enemies[i].y*scaleFactor, TILE_WIDTH*scaleFactor, TILE_HEIGHT*scaleFactor);\n\n    }\n\n    \n\n    // draw the onscreen part\n\n    noFill();\n\n    stroke(0, 0, 255);\n\n    rect(-scrollX*scaleFactor, -scrollY*scaleFactor, SCREEN_COLS*TILE_WIDTH*scaleFactor, SCREEN_ROWS*TILE_HEIGHT*scaleFactor);\n\n};\n\n\n\nvar timer = function() {\n\n    if (hero.wounded && t - hero.lastWounded > 60) {\n\n        hero.wounded = false;\n\n    }\n\n    t += 1;\n\n};\n\n\n\nvar timer = function() {\n\n\n\n    if (hero.wounded && t - hero.lastWounded > 60) {\n\n\n\n        hero.wounded = false;\n\n\n\n    }\n\n\n\n    t += 1;\n\n\n\n};\n\n\n\nvar drawGameover = function() {\n\n\n\n    if (lives === 0) {\n\n\n\n        fill(250, 188, 0);\n\n    \n\n        rect(77, 124, 255, 140);\n\n\n\n        textSize(20);\n\n\n\n        fill(255, 0, 0);\n\n\n\n        text (\"GAME OVER!\", 143, 150);\n\n        \n\n        text (\"To play again click Restart\", 89, 170);\n\n        \n\n        text (\"Score: \" + score, 152, 228);\n\n\n\n        hero = false;\n\n        \n\n        isGameOver = true;\n\n\n\n    }\n\n\n\n};\n\n\n\nvar drawVictory = function() {\n\n    \n\n    if (victory === 0) {\n\n        \n\n        if (robots === 0) {        \n\n        \n\n        fill(250, 188, 0);\n\n    \n\n        rect(77, 124, 255, 140);\n\n\n\n        textSize(20);\n\n\n\n        fill(255, 0, 0);\n\n\n\n        text (\"VICTORY!\", 158, 150);\n\n        \n\n        text (\"To play again click Restart\", 89, 170);\n\n        \n\n        if (lives === 3) {\n\n    \n\n            score = score + 3000;\n\n    \n\n        }\n\n\n\n        if (lives === 2) {\n\n    \n\n            score = score + 2000;\n\n            \n\n            text (\"Thats all u got? you lost 1\", 90, 230);\n\n            \n\n            text (\"of your lives!\", 90, 250);\n\n    \n\n        }\n\n\n\n        if (lives === 1) {\n\n            \n\n            score = score + 1000;\n\n            \n\n            text (\"Come on 2 lives lost!?!?!?\", 90, 245);\n\n    \n\n        }\n\n        \n\n        text (\"Score: \" + score, 152, 202);\n\n            \n\n        }\n\n        \n\n        hero = false;\n\n        \n\n        isGameOver = true;\n\n        \n\n    }\n\n\n\n};\n\n\n\nvar drawStats = function() {\n\n    \n\n    \n\n    \n\n    if (victory === 1 && lives > 0) {\n\n        \n\n       strokeWeight(2);\n\n    \n\n       fill(250, 188, 0);\n\n     \n\n       rect(0, 368, 416, 31);\n\n\n\n       fill(255, 0, 0);\n\n    \n\n       textSize(17);\n\n       \n\n       text (\"Score: \" + score, 12, 389);\n\n    \n\n       text (\"Lives: \" + lives, 166, 389);\n\n       \n\n       text (\"Robots: \" + robots, 274, 389);\n\n       if (powerup === 0) {\n\n           text(\"Down arrow uses the gem and gives you points.\", 22, 24);\n\n       }\n\n       \n\n    } \n\n\n\n};\n\n\n\nvar draw = function() {\n\n    if(!isGameOver){\n\n        update();\n        \n        drawBackground();\n\n        drawMapBelowHero();\n\n        drawEnemies();\n\n        drawDude(hero);\n\n        drawMapAboveHero();\n\n        drawGameover();\n\n        drawVictory(); \n\n        drawStats();\n\n        //drawDebugInfo(1/10);\n\n        timer();\n\n        if(gamestart === false) {\n\n            GameIntro();\n\n        }\n\n    }\n\n};";
window.liveEditor = new LiveEditor({
                el: $("#sample-live-editor"),
                code: code,
                width: 400,
                height: 400,
                editorHeight: "80%",
                autoFocus: true,
                workersDir: "../../build/workers/",
                externalsDir: "../../build/external/",
                imagesDir: "../../build/images/",
                soundsDir: "../../sounds/",
                execFile: outputUrl,
                jshintFile: "../../build/external/jshint/jshint.js",
                newErrorExperience: true,
            });
            liveEditor.editor.on("change", function() {
                window.localStorage["test-code"] = liveEditor.editor.text();
            });
            ScratchpadAutosuggest.init(liveEditor.editor.editor);
            </script>
        </body>
        </html>
        